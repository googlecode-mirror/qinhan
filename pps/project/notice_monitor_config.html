<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<?php
$day_array = array('星期一'=>1,'星期二'=>2,'星期三'=>3,'星期四'=>4,'星期五'=>5,'星期六'=>6,'星期天'=>0);
?>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
    <title>配置中心 - PPS监控后台</title>
    <link href="/project/commstyle/css/inspect2.css" rel="stylesheet" type="text/css"/>
    <link href="/project/commstyle/css/rating.source.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="/project/commstyle/js/jquery.js"></script>
    <script type="text/javascript" src="/project/commstyle/js/inspect2.js?v=20121111"></script>
    <script>
        $.ajaxSetup({
            ajaxSettings: { contentType: "application/x-www-form-urlencoded;chartset=GB2312"}
        });
    </script>
    <style>
        .red {
            color: #F00;
        }

        * {
            font-family: 微软雅黑 !important
        }
    </style>
    <script>
        function edit_as_name(obj, id) {
            var txt = $(obj).html();
            if (txt.indexOf('<input') > -1) {
                return;
            }
            $(obj).html('<input class="inpm" onkeydown="if (event.keyCode==13) return false;" onblur="edit_as_name_do(this,' + id + ')" id="as_name_id_' + id + '" name="as_name" value="' + txt + '">');
            $('#as_name_id_' + id)[0].select();
        }
        function edit_as_name_do(obj, id) {
            if (obj.value != "")
                $.post("?act=report_monitor_as_name&sign=<?php echo SIGN_KEY?>", {as_name: obj.value, id: id});
            $(obj).parent().bind('click', function (data) {
                edit_as_name($(this)[0], id)
            });
            $(obj).parent().html(obj.value);
        }
        function receive_change() {
            var receive_type = document.getElementById('receive_type').value;
            if (receive_type == '2') {
                $("[name='resive']").html('请输入手机号码(多个号码,分割)');
                $("#show1").css("display", 'none');
                $("#show2").css("display", '');
                $("#show3").css("display", "none");

            }
            if (receive_type == '1') {
                $("[name='resive']").html('请输入邮箱地址（多个邮箱,分割）');
                $("#show1").css("display", '');
                $("#show2").css("display", 'none');
                $("#show3").css("display", "none");
            }
            if (receive_type == '3') {
                $("[name='resive']").html('请输入接口名称(多个接口,分割)');
                $("#show1").css("display", 'none');
                $("#show2").css("display", 'none');
                $("#show3").css("display", "");
            }
        }
    </script>
</head>
<body>
<div id="wrapper">
<?php if($_REQUEST['type']!='update'){?>
<?php include "_header.html";?>
<!--container-->
<div id="container">
<!--new-i-cols-->
<div class="i-cols new-i-cols">
<!--内容开始-->
<div class="i-col1">
<!--i-col1-1-->
<div id="new-i-col1-1" class="i-col1-1">
<div class="crumb">您当前的位置：应用监控 >>通知配置</div>
<div class="searchBx">
    <div class="sLok sd">
        <div class="rh-right"></div>
    </div>
</div>
<?php }?>
<!--mnav-->
<div id="main" class="mBox" style="clear:both">
<!--mnav-->
<div class="tHd">
    <div class="m-nav">
        <ul>
            <li id="li_class_<?php echo $i?>" class="cur"><a href="" title="<?php echo $v['V1']?>"><span>
                    <?php echo $this->row_config['AS_NAME1']?>
                    </span></a></li>
        </ul>
    </div>
</div>
<!--/mnav-->
<div class="tBd" style="margin-bottom:20px;">
<form action="?act=notice_monitor_v1_do&amp;v1=<?php echo rawurlencode($_REQUEST['v1'])?>" method="post"
      id="report_monitor_v1_do">
      <?php if($_REQUEST['type']=='update'){?>
      <input type="hidden" value="<?php echo $this->_row['ID'];?>" name="id" />
      <?php }?>
<?php if($_REQUEST['v3']==''){?>
<table id="assess-table" class="tabc assess-table" border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <th colspan="4" style="text-align:left; width:50%">通知配置&nbsp;<a
                href="?act=report_monitor&type=<?php echo rawurlencode($_REQUEST['v1'])?>" class="blue">返回数据指标</a></th>
    </tr>
    <tr>
        <td style="text-align:left">原名:</td>
        <td style="text-align:left">
            <?php echo $_REQUEST['v1']?>
        </td>
        <td style="text-align:left"><span style="text-align:right">接收通知工具选择</span>:</td>
        <td style="text-align:left">
            <select name="receive_type" id='receive_type' onchange="receive_change()">
                <option value="1" selected="selected">邮箱</option>
                <?php if(count($a_v2)==1){?>
                <option value="2">手机</option>
                <?php }?>
                <option value="3">接口</option>
            </select>
        </td>
    </tr>
    <tr>
        <td width="20%" style="text-align:left">邮件标题:</td>
        <td style="text-align:left">
            <input name="as_name" type="text" class="inpm" id="as_name" style="width:300px;"
                   value="<?php 
				   if($this->_row['AS_NAME']){
				   echo $this->_row['AS_NAME'];
				   }else{
				   echo $this->row_config['AS_NAME1'];
				   }?>"/>
        </td>
        <td style="text-align:left"><span style="text-align:right" name="resive">发送邮箱地址(多个邮箱,分割)</span>:</td>
        <td style="text-align:left">
            <input name="receive_value" type="text" class="inpm" id="group_name_2" style="width:200px;" value="<?php echo $this->_row['RECEIVE_VALUE']?>"/>
            &nbsp;</td>
    </tr>
    <tr id='show1' style="">
        <td style="text-align:left">发送周期:</td>
        <td style="text-align:left">
            <p>
            <?php
            	foreach($day_array as $k=>$v){?>
                  <label>
                    <input type="checkbox" checked="checked" name="notice_date[]" value="<?php echo $v?>"/>
                    <?php echo $k?>
                  </label>
               <?php }?>
                
                <br/>
            </p>
        <td style="text-align:left">发送时间点</td>
        <td style="text-align:left">
            <select name="notice_time" id="notice_time">
                <?php for($it=0;$it<=23;$it++){?>
                <option value="<?php echo $it?>"
                <?php if($this->_row['NOTICE_TIME']==$it){?>selected="selected"<?php }?> >
                <?php echo $it?>
                点</option>
                <?php }?>
            </select>
        </td>
    </tr>
    <tr id='show3' style="display:none">
        <td style="text-align:left">每小时发送频率(接收信息为接口时选项)</td>
        <td style="text-align:left">
            <select name="notice_hz" id="notice_hz">
                <?php for($it=1;$it<=60;$it++){?>
                <option value="<?php echo $it?>"
                <?php if($v['NOTICE_TIME']==$it){?>selected="selected"<?php }?> >
                <?php echo $it?>
                分</option>
                <?php }?>
            </select>
        </td>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
    <tr>
        <td style="text-align:left">时间选择</td>
        <td style="text-align:left">
            <p>
                <?php if($a_v2){?>
                <label>
                    <input type="checkbox" checked="checked" disabled="disabled" name="msg_time[]" value="1"/>
                    昨天数据</label>
                <input type="hidden" name="msg_time" value="1"/>

                <?php }else{?>
                <label>
                    <input type="checkbox" checked="checked" disabled="disabled" name="msg_time[]" value="3"/>
                    最近三十天数据</label>
                <input type="hidden" name="msg_time" value="3"/>

                <?php }?>
            </p>
        </td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
    <tr>
        <td style="text-align:left">发送数据选择</td>
        <td style="text-align:left">
            <?php if(!$a_v2){?>
            <label>
                <input type="checkbox" checked="checked" disabled="disabled" name="v2[]" value="all"/>
                汇总数据 <input type="hidden" name="v2[]" value="all"/>

            </label>
            <br/>
            <?php }else{?>
            <?php foreach($a_v2 as $kk=>$vv){ ?>
            <label>
                <input type="checkbox" checked="checked" disabled="disabled" value="<?php echo $kk?>"/>
                <?php echo $vv?>
            </label>
            <br/>
            <input type="hidden" name="v2[]" value="<?php echo $vv?>"/>
            <?php }}?>
        </td>

        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
    <tr id='show2' style="display:none">
        <td style="text-align:left">阀值(大于此值时发送通知)</td>
        <td style="text-align:left">
            <input name="max_num" type="text" class="inpm" style="width:200px;" value=""/>
        </td>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
    <tr>
        <td style="text-align:left">数据时间</td>
        <td style="text-align:left">
            <p>
                <?php if(!$a_v2){?>
                <label>
                    <input type="checkbox" checked="checked" disabled="disabled" name="msg_type[]" value="date"/>
                    天</label>
                <input type="hidden" name="msg_type" value="date"/>
                <?php }else{?>
                <label>
                    <input type="checkbox" checked="checked" disabled="disabled" name="msg_type[]" value="hour"/>
                    小时</label>
                <input type="hidden" name="msg_type" value="hour"/>
                <?php }?>
                <br/>
            </p>
        </td>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
    <tr>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">
            <input type="submit" name="button" id="button" value="提交" class="ibtn"/>
            &nbsp;&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
</table>
<?php }else{?>
<table id="assess-table" class="tabc assess-table" border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <th colspan="4" style="text-align:left; width:50%">通知配置&nbsp;<a
                href="?act=report_monitor&type=<?php echo rawurlencode($_REQUEST['v1'])?>" class="blue">返回数据指标</a></th>
    </tr>
    <tr>
        <td style="text-align:left">原名:</td>
        <td style="text-align:left">
            <?php echo $_REQUEST['v1']?>
        </td>
        <td style="text-align:left"><span style="text-align:right">接收通知工具选择</span>:</td>
        <td style="text-align:left">
            <select name="receive_type" id='receive_type' onchange="receive_change()">
                <option value="3" selected="selected">预警接口</option>
            </select>
        </td>
    </tr>
    <tr>
        <td width="20%" style="text-align:left">v1:</td>
        <td style="text-align:left">
            <input name="as_name" type="text" class="inpm" id="as_name" style="width:300px;"
                   value="<?php echo $this->row_config['AS_NAME1']?>"/>
        </td>
        <td style="text-align:left"><span style="text-align:right" name="sid">sid</span>:</td>
        <td style="text-align:left">
            <input name="sid" type="text" class="inpm" style="width:200px;" value=""/>
            &nbsp;</td>
    </tr>

    <tr>
        <td style="text-align:left">发送频率</td>
        <td style="text-align:left">
            <select name="notice_hz" id="notice_hz">
                <?php for($it=1;$it<=60;$it++){?>
                <option value="<?php echo $it?>"
                <?php if($this->_row['NOTICE_TIME']==$it){?>selected="selected"<?php }?> >
                <?php echo $it?>
                分</option>
                <?php }?>
            </select>
        </td>
        <td style="text-align:left">最大值</td>
        <td style="text-align:left"><input type="text" name="max_num"></td>
    </tr>
    <tr>
        <td style="text-align:left">预警v2</td>
        <td style="text-align:left">
            <p>
                <?php echo $_REQUEST['v2']?>
                <input type="hidden" value="<?php echo $_REQUEST['v2']?>" name="v2">
            </p>
        </td>
        <td style="text-align:left">最小值</td>
        <td style="text-align:left"><input type="text" name="min_num"></td>

    </tr>
    <tr>
        <td style="text-align:left">预警项</td>
        <td style="text-align:left">
            <p>
                <?php echo $_REQUEST['v3']?>
                <input type="hidden" value="<?php echo $_REQUEST['v3']?>" name="v3">
            </p>
        </td>

        <td style="text-align:left">邮箱:</td>
        <td style="text-align:left"><input type="text" name="receive_value"></td>
    </tr>


    <tr>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">
            <input type="submit" name="button" id="button" value="提交" class="ibtn"/>
            &nbsp;&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
        <td style="text-align:left">&nbsp;</td>
    </tr>
</table>
<?php }?>
</form>
</div>

<!--/main-->
<!--/内容结束!!!-->
</div>
<!--/i-col1-1-->
</div>
<!--/内容结束-->
</div>
<!--/new-i-cols-->
</div>
<!--/container-->
<?php if($_REQUEST['type']!='update'){
       include "_footer.html";
}?>
</div>
<!--wrapper-->
</body>
</html>